import{u as y,r as p,j as e,H as I}from"./app-Tym7WeGa.js";import{I as E}from"./input-error-CrKoW7Fn.js";import{B as g}from"./button-p6axQEC_.js";import{I as S}from"./input-BeIsI_qY.js";import{L as u}from"./label-D-kA4CCE.js";import{A as D}from"./AuthenticatedLayout-CmIEXCh0.js";import{T as A}from"./trash-2-BAA8ZnhI.js";/* empty css            */import"./index-BcdD4NpO.js";import"./app-layout-BLWGu8yS.js";import"./use-mobile-7AW_vrix.js";import"./index-DVZiuZ48.js";import"./createLucideIcon-Ctz4MQX9.js";import"./index-D8lDxqL2.js";import"./floating-ui.react-dom-II77FIsv.js";import"./index-DdgrMWCh.js";import"./index-C_Xnxccd.js";import"./briefcase-C5IKtrug.js";import"./users-CgARHrdU.js";import"./user-PM5uBaLl.js";import"./chevron-right-CsJ5fP8Q.js";function Y({auth:x,project:n,projectPhotos:d}){const{data:l,setData:f,post:w,processing:h,errors:j,reset:v}=y({new_photos:null}),[r,N]=p.useState(d),[c,m]=p.useState([]),P=s=>{const t=s.target.files;if(f("new_photos",t),t&&t.length>0){const a=[];for(let o=0;o<t.length;o++){const i=new FileReader;i.onloadend=()=>{a.push(i.result),a.length===t.length&&m(a)},i.readAsDataURL(t[o])}}else m([])},_=s=>{confirm("Are you sure you want to remove this photo?")&&N(r.filter(t=>t.id!==s))},b=s=>{s.preventDefault();const t=new FormData;if(l.new_photos)for(let o=0;o<l.new_photos.length;o++)t.append("new_photos[]",l.new_photos[o]);t.append("_method","put");const a=d.filter(o=>!r.some(i=>i.id===o.id)).map(o=>o.id);a.length>0&&t.append("deleted_photo_ids",JSON.stringify(a)),w(route("admin.projects.photos.update",n.id),{data:t,onSuccess:()=>{v(),m([])},forceFormData:!0})};return e.jsxs(D,{user:x.user,header:e.jsxs("h2",{className:"text-xl leading-tight font-semibold text-gray-800",children:["Manage Photos for: ",n.title]}),children:[e.jsx(I,{title:`Manage Photos for: ${n.title}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-card p-6 shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-6",children:[r.length>0&&e.jsxs("div",{children:[e.jsx(u,{children:"Existing Photos"}),e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:r.map(s=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.image,alt:s.caption||"Project Photo",className:"h-32 w-full rounded-md object-cover"}),e.jsx(g,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>_(s.id),children:e.jsx(A,{className:"h-4 w-4"})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"new_photos",children:"Add New Photos"}),e.jsx(S,{id:"new_photos",type:"file",name:"new_photos[]",className:"mt-1 block w-full",onChange:P,accept:"image/*",multiple:!0}),e.jsx(E,{message:j.new_photos,className:"mt-2"}),c.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:c.map((s,t)=>e.jsx("img",{src:s,alt:`New Image Preview ${t+1}`,className:"h-auto max-w-xs rounded-md"},t))})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(g,{type:"submit",disabled:h,children:h?"Saving...":"Save Changes"})})]})})})})]})}export{Y as default};
